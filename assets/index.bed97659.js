import{o as e,c as t,a as l,w as i,v as a,b as A,t as s,d as T,F as E,r as n,e as C,f as d,g as o,h as r}from"./vendor.ef21aba8.js";import{initializeApp as N}from"https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";import{getFirestore as h,setDoc as O,doc as c,collection as R,query as u,where as M,orderBy as p,getDocs as U,deleteDoc as g}from"https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js";import{getAuth as m,signInWithEmailAndPassword as S,signOut as y}from"https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(l){const i=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((l,A)=>{const s=new URL(e,i);if(self[t].moduleMap[s])return l(self[t].moduleMap[s]);const T=new Blob([`import * as m from '${s}';`,`${t}.moduleMap['${s}']=m;`],{type:"text/javascript"}),E=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(T),onerror(){A(new Error(`Failed to import: ${e}`)),a(E)},onload(){l(self[t].moduleMap[s]),a(E)}});document.head.appendChild(E)})),self[t].moduleMap={}}}("/april-bill/assets/");const L={props:["errorMsg"],data(){return{email:"",password:"",message:this.errorMsg}},methods:{login(){this.$emit("login",{email:this.email,password:this.password})}},watch:{errorMsg(e){this.message=e}}},_={id:"login"},I=l("h1",null,"April Bill",-1),b={class:"login-container"},D=l("div",{style:{padding:"10px 20px",background:"rgb(249, 251, 254)","border-bottom":"solid silver 1px"}}," 邮箱密码登录 ",-1),B={style:{padding:"20px"}},v={style:{color:"red"}};L.render=function(T,E,n,C,d,o){return e(),t("div",_,[I,l("div",b,[D,l("div",B,[l("p",null,[i(l("input",{placeholder:"输入邮箱",style:{width:"200px",height:"28px","padding-left":"10px",border:"solid silver 1px","border-radius":"4px"},type:"email","onUpdate:modelValue":E[1]||(E[1]=e=>d.email=e),onKeyup:E[2]||(E[2]=A(((...e)=>o.login&&o.login(...e)),["enter"]))},null,544),[[a,d.email]])]),l("p",null,[i(l("input",{placeholder:"输入密码",style:{width:"200px",height:"28px","padding-left":"10px",border:"solid silver 1px","border-radius":"4px"},type:"password","onUpdate:modelValue":E[3]||(E[3]=e=>d.password=e),onKeyup:E[4]||(E[4]=A(((...e)=>o.login&&o.login(...e)),["enter"]))},null,544),[[a,d.password]])]),l("p",null,[l("input",{style:{width:"200px",height:"34px",color:"white",background:"rgb(0, 153, 255)",border:"none","border-radius":"4px",cursor:"pointer"},type:"submit",value:"登录",onClick:E[5]||(E[5]=(...e)=>o.login&&o.login(...e))})])])]),l("p",v,s(d.message),1)])};var Y=["01","02","03","04","05","06","07","08","09",10,11,12],f=["01","02","03","04","05","06","07","08","09",10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],K=f.concat([29]),w=K.concat([30]),G=w.concat([31]);const P={name:"DatePickerUnit",props:["startYear","endYear","year","month","day"],data(){return{monthOption:Y,yearVal:this.year,monthVal:this.month,dayVal:this.day}},computed:{yearOption(){var e=(new Date).getFullYear(),t=this.startYear?this.startYear:e-10,l=this.endYear?this.endYear:e,i=[];for(let a=0;a<l-t+1;a++)i.push(t+a);return i},dayOption(){var e=this.yearVal,t=this.monthVal,l=this.dayVal,i=["01","03","05","07","08",10,12],a=["04","06","09",11];for(let A=0;A<i.length;A++)if(t==i[A])return G;for(let A=0;A<a.length;A++)if(t==a[A])return 31==l&&(this.dayVal=""),w;return e%4==0&&e%100!=0||e%400==0?(l>29&&(this.dayVal=""),K):(l>28&&(this.dayVal=""),f)}},methods:{getDateVal(){this.$emit("dateChanged",{year:this.yearVal,month:this.monthVal,day:this.dayVal})}},watch:{year(e){this.yearVal=e},month(e){this.monthVal=e},day(e){this.dayVal=e}}},x=C(" 年 "),k=C(" 月 "),V=C(" 日 ");P.render=function(a,A,C,d,o,r){return e(),t("div",null,[i(l("select",{class:"date-picker-select","onUpdate:modelValue":A[1]||(A[1]=e=>o.yearVal=e),onChange:A[2]||(A[2]=(...e)=>r.getDateVal&&r.getDateVal(...e))},[(e(!0),t(E,null,n(r.yearOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],544),[[T,o.yearVal]]),x,i(l("select",{class:"date-picker-select","onUpdate:modelValue":A[3]||(A[3]=e=>o.monthVal=e),onChange:A[4]||(A[4]=(...e)=>r.getDateVal&&r.getDateVal(...e))},[(e(!0),t(E,null,n(o.monthOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],544),[[T,o.monthVal]]),k,i(l("select",{class:"date-picker-select","onUpdate:modelValue":A[5]||(A[5]=e=>o.dayVal=e),onChange:A[6]||(A[6]=(...e)=>r.getDateVal&&r.getDateVal(...e))},[(e(!0),t(E,null,n(r.dayOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],544),[[T,o.dayVal]]),V])};var j=[{id:"BOOK001",CURRENCY:"HKD",ACCOUNT:[{id:"ACC001",NAME:"现金",TYPE:"现金/储值卡"},{id:"ACC002",NAME:"交通卡",TYPE:"现金/储值卡"},{id:"ACC003",NAME:"信用卡A",TYPE:"信用卡"},{id:"ACC004",NAME:"储蓄卡A",TYPE:"储蓄卡"}],BILL:[{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-07-14",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230714001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-07-14",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230714002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-14",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230714003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-07-14",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230714004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-07-14",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230714005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-07-13",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230713001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-07-13",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230713002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-13",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230713003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-07-13",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230713004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-07-13",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230713005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-07-12",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230712001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-07-12",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230712002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-12",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230712003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-07-12",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230712004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-07-12",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230712005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-07-11",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230711001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-07-11",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230711002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-11",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230711003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-07-11",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230711004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-07-11",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230711005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-07-10",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230710001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-07-10",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230710002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-10",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230710003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-07-10",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230710004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-07-10",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230710005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-07-09",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230709001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-07-09",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230709002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-09",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230709003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-07-09",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230709004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-07-09",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230709005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-07-08",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230708001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-07-08",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230708002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-08",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230708003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-07-08",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230708004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-07-08",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230708005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-07-07",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230707001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-07-07",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230707002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-07",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230707003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-07-07",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230707004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-07-07",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230707005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-07-06",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230706001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-07-06",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230706002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-06",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230706003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-07-06",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230706004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-07-06",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230706005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-07-05",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230705001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-07-05",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230705002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-05",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230705003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-07-05",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230705004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-07-05",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230705005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-07-04",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230704001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-07-04",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230704002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-04",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230704003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-07-04",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230704004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-07-04",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230704005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-07-03",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230703001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-07-03",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230703002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-03",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230703003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-07-03",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230703004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-07-03",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230703005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-07-02",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230702001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-07-02",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230702002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-02",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230702003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-07-02",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230702004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-07-02",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230702005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-07-01",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230701001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-07-01",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230701002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-07-01",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230701003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-07-01",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230701004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-07-01",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230701005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-06-30",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230630001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-06-30",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230630002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-06-30",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230630003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-06-30",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230630004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-06-30",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230630005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-06-29",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230629001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-06-29",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230629002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-06-29",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230629003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-06-29",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230629004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-06-29",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230629005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-06-28",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230628001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-06-28",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230628002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-06-28",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230628003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-06-28",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230628004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-06-28",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230628005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-06-27",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230627001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-06-27",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230627002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-06-27",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230627003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-06-27",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230627004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-06-27",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230627005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:140.4,CATEGORY:"饮食",DATE:"2023-06-26",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230626001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"现金",AMOUNT:35,CATEGORY:"饮食",DATE:"2023-06-26",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230626002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"交通卡",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-06-26",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230626003"},{NAME:"交通卡充值",ACC_IN:"交通卡",ACC_OUT:"信用卡A",AMOUNT:200,CATEGORY:"转账",DATE:"2023-06-26",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230626004"},{NAME:"同事餐费",ACC_IN:"现金",ACC_OUT:"",AMOUNT:100,CATEGORY:"收到钱款",DATE:"2023-06-26",NATURE:"收入",NOTES:"",REMARK:"",id:"BILL20230626005"},{NAME:"午饭",ACC_IN:"",ACC_OUT:"储蓄卡A",AMOUNT:30,CATEGORY:"饮食",DATE:"2023-06-25",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230625001"},{NAME:"早饭",ACC_IN:"",ACC_OUT:"支付宝",AMOUNT:40,CATEGORY:"饮食",DATE:"2023-06-25",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230625002"},{NAME:"晚饭",ACC_IN:"",ACC_OUT:"微信",AMOUNT:50,CATEGORY:"饮食",DATE:"2023-06-25",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230625003"},{NAME:"超市采购",ACC_IN:"",ACC_OUT:"信用卡A",AMOUNT:150,CATEGORY:"购物",DATE:"2023-06-25",NATURE:"支出",NOTES:"",REMARK:"",id:"BILL20230625004"},{NAME:"信用卡A还款",ACC_IN:"信用卡A",ACC_OUT:"储蓄卡A",AMOUNT:300,CATEGORY:"转账",DATE:"2023-06-25",NATURE:"转账",NOTES:"",REMARK:"",id:"BILL20230625005"}],CATEGORY:[{id:"CAT000",NAME:"转账",TYPE:"转账"},{id:"CAT001",NAME:"生活缴费",TYPE:"支出"},{id:"CAT002",NAME:"饮食",TYPE:"支出"},{id:"CAT003",NAME:"医疗",TYPE:"支出"},{id:"CAT004",NAME:"交通",TYPE:"支出"},{id:"CAT005",NAME:"购物",TYPE:"支出"},{id:"CAT006",NAME:"娱乐",TYPE:"支出"},{id:"CAT007",NAME:"人情",TYPE:"支出"},{id:"CAT008",NAME:"其他",TYPE:"支出"},{id:"CAT009",NAME:"工资入账",TYPE:"收入"},{id:"CAT010",NAME:"收到钱款",TYPE:"收入"}]}],F=j.ACCOUNT,W=j.CATEGORY,$=j.BILL;const z=h(N({apiKey:"AIzaSyBzxFOF7P9rM5UvpKyUxHqlghUNJeuZzK8",authDomain:"april-bill.firebaseapp.com",projectId:"april-bill",storageBucket:"april-bill.appspot.com",messagingSenderId:"359825891077",appId:"1:359825891077:web:f421390c6f59d71f5ea16c"})),H=m();var q=!1;localStorage.getItem("uid")&&(q=!0);var J=function(e){return{NAME:e.NAME,ACC_IN:e.ACC_IN,ACC_OUT:e.ACC_OUT,AMOUNT:e.AMOUNT,CATEGORY:e.CATEGORY,DATE:e.DATE,NATURE:e.NATURE,NOTES:e.NOTES,REMARK:e.REMARK,id:e.id}},Z=function(e){return{id:e.id,NAME:e.NAME,TYPE:e.TYPE}},Q=function(e){return{id:e.id,NAME:e.NAME,TYPE:e.TYPE}},X={NAME:"",ACC_IN:"",ACC_OUT:"",AMOUNT:"",CATEGORY:"",DATE:"",NATURE:"",NOTES:"",REMARK:"",id:""};const ee={components:{Login:L,DatePickerUnit:P},name:"April-Bill",data:()=>({perPageSelected:10,curPage:99,prevPage:0,nextPage:0,startYear:2020,endYear:2030,natureOption:["支出","收入","转账"],perPageOption:[1,3,5,7,10,20,30,40],pageNumOption:[],billTemplateOption:[],curPageBills:[],bills:[],accounts:[],categories:[],isShowOverlay:!1,isShowBill:!1,isShowAcc:!1,isShowCat:!1,isShowSumAcc:!1,isShowSumCat:!1,isUpdateBill:!0,billSelected:{},billTemplateName:"",billTemplates:[],accEditing:[],catEditing:[],sumAcc:[],activeSumAccType:"",sumCat:[],activeSumCatType:"",expenseTotal:0,incomeTotal:0,reserveTotal:{val:0,text:"0.00"},filter:{startDate:{year:"",month:"",day:""},endDate:{year:"",month:"",day:""},perPage:10},searchKW:"",searchResultClass:[],isLoggedin:q,isGuestMode:!1,login_errMsg:""}),computed:{prevNext(){return{prevStyle:this.prevPage?"":"disabled",nextStyle:this.nextPage?"":"disabled"}},categoryOption(){var e=this.billSelected.NATURE,t=[];for(let l=0;l<this.categories.length;l++)this.categories[l].TYPE==e&&t.push(this.categories[l].NAME);return t}},methods:{loadNewBill(e){this.bills=this.getFilteredBills($,this.filter),this.accounts=F,this.categories=W;var t=this.bills.length,l=this.perPageSelected,i=Math.ceil(t/l),a=[];for(let A=1;A<i+1;A++)a.push(A);this.pageNumOption=a,this.filter.perPage=l,this.curPage=e,this.loadBill(),this.expenseTotal=this.getExpenseTotal(this.bills),this.incomeTotal=this.getIncomeTotal(this.bills),this.reserveTotal=this.getReserveTotal(this.expenseTotal,this.incomeTotal),this.getSumAcc(),this.getSumCat(),this.clearSearch()},loadBill(){var e=this.bills.length,t=this.curPage,l=this.filter.perPage;if(0!=e){var i=Math.ceil(e/l),a=this.skipNumber(),A=this.bills.slice(a,a+l);this.curPageBills=A,this.prevPage=t-1,this.nextPage=t==i?0:t+1}else this.curPageBills=[]},loadAccCat(){},goToPrev(){0!=this.prevPage&&(this.curPage--,this.loadBill())},goToNext(){0!=this.nextPage&&(this.curPage++,this.loadBill())},showBillDetail(e){if(this.showOverlay(),this.isShowBill=!0,this.billTemplateName="",-1!=e){var t=this.curPageBills[e];this.isUpdateBill=!0,this.billSelected=J(t),this.billSelected.year=t.DATE.substring(0,4),this.billSelected.month=t.DATE.substring(5,7),this.billSelected.day=t.DATE.substring(8,10)}else{this.isUpdateBill=!1,this.billSelected=J(X);let e=new Date,t=e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,l=e.getDate()<9?"0"+e.getDate():e.getDate();this.billSelected.year=e.getFullYear(),this.billSelected.month=t,this.billSelected.day=l,this.billSelected.DATE=[e.getFullYear(),t,l].join("-")}},showAccDetail(){this.showOverlay(),this.isShowAcc=!0,this.accEditing=[];var e=this.accounts;for(let t=0;t<e.length;t++)this.accEditing.push(Z(e[t]))},showCatDetail(){this.showOverlay(),this.isShowCat=!0,this.catEditing=[];var e=this.categories;for(let t=1;t<e.length;t++)this.catEditing.push(Q(e[t]))},showSumAcc(){this.showOverlay(),this.isShowSumAcc=!0,this.sumAcc.length&&this.setActiveSumAccType(this.sumAcc[0][0].TYPE)},showSumCat(){this.showOverlay(),this.isShowSumCat=!0,this.sumCat.length&&this.setActiveSumCatType(this.sumCat[0][0].TYPE)},showOverlay(){this.isShowOverlay=!0},hideOverlay(){this.isShowOverlay=!1,this.isShowBill=!1,this.isShowAcc=!1,this.isShowCat=!1,this.isShowSumAcc=!1,this.isShowSumCat=!1},async updateBill(){var e=!!this.billSelected.NAME&&!!this.billSelected.AMOUNT,t=!1;t="转账"==this.billSelected.NATURE?!!this.billSelected.ACC_OUT&&!!this.billSelected.ACC_IN:!!this.billSelected.ACC_OUT||!!this.billSelected.ACC_IN;var l=!!this.billSelected.CATEGORY&&!!this.billSelected.DATE,i=!!this.billSelected.NATURE;if(e&&t&&l&&i){if(confirm("确认更新吗？")){var a=J(this.billSelected);a.DATE=[this.billSelected.year,this.billSelected.month,this.billSelected.day].join("-"),await O(c(z,"BOOK/BOOK001/BILL",a.id),a),this.isShowOverlay=!1,this.isShowBill=!1;const e=R(z,"BOOK/BOOK001/BILL");var A=[this.filter.startDate.year,this.filter.startDate.month,this.filter.startDate.day].join("-"),s=[this.filter.endDate.year,this.filter.endDate.month,this.filter.endDate.day].join("-");const t=u(e,M("DATE",">=",A),M("DATE","<=",s),p("DATE","desc")),l=await U(t);$=[],l.forEach((e=>{let t=e.data();t.id=e.id,$.push(J(t))})),this.loadNewBill(this.curPage)}}else alert("请填写所有必填项")},async addBill(){var e=!!this.billSelected.NAME&&!!this.billSelected.AMOUNT,t=!1;t="转账"==this.billSelected.NATURE?!!this.billSelected.ACC_OUT&&!!this.billSelected.ACC_IN:!!this.billSelected.ACC_OUT||!!this.billSelected.ACC_IN;var l=!!this.billSelected.CATEGORY&&!!this.billSelected.DATE,i=!!this.billSelected.NATURE;if(e&&t&&l&&i){if(confirm("确认新建吗？")){var a=new Date,A=a.getFullYear(),s=a.getMonth()+1;s=s<10?"0"+s:s;var T=a.getDate();T=T<10?"0"+T:T;var E=a.getHours();E=E<10?"0"+E:E;var n=a.getMinutes();n=n<10?"0"+n:n;var C=a.getSeconds(),d="BILL"+[A,s,T,E,n,C=C<10?"0"+C:C].join(""),o=J(this.billSelected);o.DATE=[this.billSelected.year,this.billSelected.month,this.billSelected.day].join("-"),o.id=d,await O(c(z,"BOOK/BOOK001/BILL",o.id),o),this.isShowOverlay=!1,this.isShowBill=!1;const e=R(z,"BOOK/BOOK001/BILL");var r=[this.filter.startDate.year,this.filter.startDate.month,this.filter.startDate.day].join("-"),N=[this.filter.endDate.year,this.filter.endDate.month,this.filter.endDate.day].join("-");const t=u(e,M("DATE",">=",r),M("DATE","<=",N),p("DATE","desc")),l=await U(t);$=[],l.forEach((e=>{let t=e.data();t.id=e.id,$.push(J(t))})),this.loadNewBill(1)}}else alert("请填写所有必填项")},async delBill(e){if(confirm("确认删除吗？")){await g(c(z,"BOOK/BOOK001/BILL",e));const i=R(z,"BOOK/BOOK001/BILL");var t=[this.filter.startDate.year,this.filter.startDate.month,this.filter.startDate.day].join("-"),l=[this.filter.endDate.year,this.filter.endDate.month,this.filter.endDate.day].join("-");const a=u(i,M("DATE",">=",t),M("DATE","<=",l),p("DATE","desc")),A=await U(a);$=[],A.forEach((e=>{let t=e.data();t.id=e.id,$.push(J(t))})),this.loadNewBill(this.curPage)}},addAcc(e){var t=e<9?"00"+(e+1):e<99?"0"+(e+1):e+1;this.accEditing.push({id:"ACC"+t,NAME:"",TYPE:""})},async updateAcc(){if(confirm("确认更新吗？")){var e=this.accEditing;this.accounts=[];for(let t=0;t<e.length;t++){let l=t<9?"00"+(t+1):t<99?"0"+(t+1):t+1;e[t].NAME&&e[t].TYPE?(this.accounts.push({id:"ACC"+l,NAME:e[t].NAME,TYPE:e[t].TYPE}),await O(c(z,"BOOK/BOOK001/ACCOUNT",e[t].id),{id:"ACC"+l,NAME:e[t].NAME,TYPE:e[t].TYPE})):await g(c(z,"BOOK/BOOK001/ACCOUNT",e[t].id))}this.hideOverlay(),this.getSumAcc()}},addCat(e){var t=e<10?"00"+e:e<100?"0"+e:e;this.catEditing.push({id:"CAT"+t,NAME:"",TYPE:""})},async updateCat(){if(confirm("确认更新吗？")){var e=this.catEditing;this.categories=[{id:"CAT000",NAME:"转账",TYPE:"转账"}];for(let t=0;t<e.length;t++)if(e[t].NAME&&e[t].TYPE){let l=t<9?"00"+(t+1):t<99?"0"+(t+1):t+1;this.categories.push({id:"CAT"+l,NAME:e[t].NAME,TYPE:e[t].TYPE}),await O(c(z,"BOOK/BOOK001/CATEGORY",e[t].id),{id:"CAT"+l,NAME:e[t].NAME,TYPE:e[t].TYPE})}else await g(c(z,"BOOK/BOOK001/CATEGORY",e[t].id));this.hideOverlay(),this.getSumCat()}},loadCategory(){"支出"==this.billSelected.NATURE&&(this.billSelected.ACC_IN=""),"收入"==this.billSelected.NATURE&&(this.billSelected.ACC_OUT=""),"转账"==this.billSelected.NATURE&&(this.billSelected.CATEGORY="转账")},skipNumber(){var e=this.bills.length,t=this.filter.perPage,l=this.curPage,i=Math.ceil(e/t);return 1===l?0:l===i?e-(e%t==0?t:e%t):(l-1)*t},setActiveSumAccType(e){this.activeSumAccType=e},setActiveSumCatType(e){this.activeSumCatType=e},getExpenseTotal:(e,t)=>e.reduce((function(e,l){if("支出"==l.NATURE){return((100*e+100*l.AMOUNT)/100).toFixed(2)}if(t&&l.ACC_OUT==t){return((100*e+100*l.AMOUNT)/100).toFixed(2)}return(1*e).toFixed(2)}),(0).toFixed(2)),getIncomeTotal:(e,t)=>e.reduce((function(e,l){if("收入"==l.NATURE){return((100*e+100*l.AMOUNT)/100).toFixed(2)}if(t&&l.ACC_IN==t){return((100*e+100*l.AMOUNT)/100).toFixed(2)}return(1*e).toFixed(2)}),(0).toFixed(2)),getReserveTotal(e,t){let l=(100*t-100*e)/100,i=String(l>0?l.toFixed(2):(-1*l).toFixed(2));return{val:l,text:i}},getSumAcc(){var e=this,t=this.accounts,l={};for(let E=0;E<t.length;E++)l[t[E].NAME]={TYPE:t[E].TYPE,bills:[]};var i={};for(let E=0;E<t.length;E++)i[t[E].TYPE]?i[t[E].TYPE].push(t[E].NAME):i[t[E].TYPE]=[t[E].NAME];var a=Object.keys(i),A=this.bills;for(let E=0;E<A.length;E++)"支出"==A[E].NATURE?l[A[E].ACC_OUT]&&l[A[E].ACC_OUT].bills.push(A[E]):"收入"==A[E].NATURE?l[A[E].ACC_IN]&&l[A[E].ACC_IN].bills.push(A[E]):(l[A[E].ACC_OUT].bills.push(A[E]),l[A[E].ACC_IN].bills.push(A[E]));var s=function(t,l,i){let a=e.getExpenseTotal(i,t),A=e.getIncomeTotal(i,t);return{NAME:t,TYPE:l,expenseTotal:a,incomeTotal:A,reserveTotal:e.getReserveTotal(a,A)}},T=[];for(let E=0;E<a.length;E++){let e=a[E],t=[];for(let a=0;a<i[e].length;a++){let A=i[e][a],T=s(A,e,l[A].bills);t.push(T)}T.push(t)}this.sumAcc=T,this.setActiveSumAccType(T[0][0].TYPE)},getSumCat(){var e=this.categories,t={};for(let n=0;n<e.length;n++)t[e[n].NAME]={TYPE:e[n].TYPE,bills:[]};var l={"支出":[],"收入":[],"转账":[]};for(let n=0;n<e.length;n++)l[e[n].TYPE].push(e[n].NAME);var i=["支出","收入","转账"],a=this.bills;for(let n=0;n<a.length;n++)t[a[n].CATEGORY]&&t[a[n].CATEGORY].bills.push(a[n]);var A,s,T,E=[];for(let n=0;n<i.length;n++){let e=i[n],a=[];for(let i=0;i<l[e].length;i++){let E=l[e][i],n=(A=E,s=e,T=t[E].bills,{NAME:A,TYPE:s,total:T.reduce((function(e,t){return((100*e+100*t.AMOUNT)/100).toFixed(2)}),(0).toFixed(2))});a.push(n)}E.push(a)}this.sumCat=E,this.setActiveSumCatType(E[0][0].TYPE)},getReserveClass(e){let t=e<0;return{"txt-green":!t,"txt-red":t}},getTypeClass:e=>({"txt-green":"收入"==e,"txt-red":"支出"==e}),getTxtClass:e=>({green:"收入"==e,red:"支出"==e,orange:"转账"==e}),getSumAccTypeClass(e){let t=e==this.activeSumAccType;return{show:t,hide:!t}},getSumAccBtnClass(e){return{disabled:e==this.activeSumAccType}},getSumCatTypeClass(e){let t=e==this.activeSumCatType;return{show:t,hide:!t}},getSumCatBtnClass(e){return{disabled:e==this.activeSumCatType}},getFilteredBills(e,t){var l=[t.startDate.year,t.startDate.month,t.startDate.day].join("-"),i=[t.endDate.year,t.endDate.month,t.endDate.day].join("-"),a=new Date(l),A=new Date(i);return e.filter((function(e){var t=new Date(e.DATE);return t>=a&&t<=A}))},changeBillDate(e){this.billSelected.year=e.year,this.billSelected.month=e.month,this.billSelected.day=e.day,this.billSelected.DATE=[e.year,e.month,e.day].join("-")},changeFilterStartDate(e){this.filter.startDate.year=e.year,this.filter.startDate.month=e.month,this.filter.startDate.day=e.day,this.filter.startDate.DATE=[e.year,e.month,e.day].join("-")},changeFilterEndDate(e){this.filter.endDate.year=e.year,this.filter.endDate.month=e.month,this.filter.endDate.day=e.day,this.filter.endDate.DATE=[e.year,e.month,e.day].join("-")},searchWithinPage(){var e=this.searchKW,t=this.curPageBills,l=[];for(let i=0;i<t.length;i++){-1!=[t[i].NAME,t[i].CATEGORY,t[i].ACC_IN,t[i].ACC_OUT].join("").indexOf(e)?l.push(""):l.push("hide")}this.searchResultClass=l},clearSearch(){this.searchKW="";var e=this.curPageBills,t=[];for(let l=0;l<e.length;l++)t.push("");this.searchResultClass=t},getLoginInfo(e){var t=e.email,l=e.password;S(H,t,l).then((e=>{localStorage.setItem("uid",e.user.uid),this.isLoggedin=!0,this.login_errMsg="",this.init()})).catch((e=>{e.code;const t=e.message;localStorage.removeItem("uid"),this.login_errMsg=t}))},logout(){y(H).then((()=>{localStorage.removeItem("uid"),this.isLoggedin=!1})).catch((e=>{console.log(e)}))},getLastMonth(){var e=new Date,t=e.getFullYear(),l=e.getMonth()+1,i=e.getDate();i=i<10?"0"+i:i;var a=1==(l=l<10?"0"+l:l)?12:l-1,A=12==(a=a<10?"0"+a:a)?t-1:t,s=new Date(A,a-1,i),T=s.getDate(),E=(T<i?new Date(A,a-1,i-T):s).getDate();return{startDate:{year:A,month:a,day:E=E<10?"0"+E:E},endDate:{year:t,month:l,day:i}}},async init(){var e=this.getLastMonth();this.filter.startDate=e.startDate,this.filter.endDate=e.endDate;const t=await U(R(z,"BOOK/BOOK001/ACCOUNT")),l=await U(R(z,"BOOK/BOOK001/CATEGORY")),i=R(z,"BOOK/BOOK001/BILL");var a=[this.filter.startDate.year,this.filter.startDate.month,this.filter.startDate.day].join("-"),A=[this.filter.endDate.year,this.filter.endDate.month,this.filter.endDate.day].join("-");const s=u(i,M("DATE",">=",a),M("DATE","<=",A),p("DATE","desc")),T=await U(s),E=await U(R(z,"BOOK/BOOK001/BILL_template"));F=[],t.forEach((e=>{let t=e.data();t.id=e.id,F.push(Z(t))})),W=[],l.forEach((e=>{let t=e.data();t.id=e.id,W.push(Q(t))})),$=[],T.forEach((e=>{let t=e.data();t.id=e.id,$.push(J(t))})),this.billTemplates=[],E.forEach((e=>{let t=e.data();t.id=e.id,this.billTemplateOption.push(t.NAME),this.billTemplates.push(J(t))})),this.loadNewBill(1)},loadToday(){var e=new Date,t=e.getFullYear(),l=e.getMonth()+1;l=l<10?"0"+l:l;var i=e.getDate();i=i<10?"0"+i:i,this.billSelected.year=t,this.billSelected.month=l,this.billSelected.day=i,this.billSelected.DATE=[t,l,i].join("-")},loadBillTemplate(){var e=this.billTemplateName,t=this.billTemplates;for(let l=0;l<t.length;l++)if(e==t[l].NAME){let e=this.billSelected.year,i=this.billSelected.month,a=this.billSelected.day;return this.billSelected=J(t[l]),this.billSelected.year=e,this.billSelected.month=i,void(this.billSelected.day=a)}},async saveBillTemplate(){if(confirm("确定保存模板吗？")){var e=this.billSelected.NAME,t=this.billTemplates,l=t.length,i=J(this.billSelected);i.DATE="";var a="";for(let s=0;s<l;s++)if(e==t[s].NAME){a=t[s].id,i.id=a,await O(c(z,"BOOK/BOOK001/BILL_template",a),i);const e=await U(R(z,"BOOK/BOOK001/BILL_template"));return this.billTemplates=[],this.billTemplateOption=[],void e.forEach((e=>{let t=e.data();t.id=e.id,this.billTemplateOption.push(t.NAME),this.billTemplates.push(J(t))}))}a=l<9?"template00"+(l+1):l<99?"template0"+(l+1):"template"+(l+1),i.id=a,await O(c(z,"BOOK/BOOK001/BILL_template",a),i);const A=await U(R(z,"BOOK/BOOK001/BILL_template"));this.billTemplates=[],this.billTemplateOption=[],A.forEach((e=>{let t=e.data();t.id=e.id,this.billTemplateOption.push(t.NAME),this.billTemplates.push(J(t))}))}},async delBillTemplate(){if(confirm("确定删除模板吗？")){var e=this.billSelected.NAME,t=this.billTemplates,l=t.length,i="";for(let a=0;a<l;a++)if(e==t[a].NAME){i=t[a].id,await g(c(z,"BOOK/BOOK001/BILL_template",i));const e=await U(R(z,"BOOK/BOOK001/BILL_template"));return this.billTemplates=[],this.billTemplateOption=[],void e.forEach((e=>{let t=e.data();t.id=e.id,this.billTemplateOption.push(t.NAME),this.billTemplates.push(J(t))}))}alert("没有这个模板")}}},created(){this.isLoggedin&&this.init()}},te={id:"app"},le={key:0,class:"main-container"},ie={class:"loadbill-setting"},ae=l("h3",null,"筛选条件",-1),Ae={class:"loadbill-set-unit"},se=C(" 开始时间 "),Te=C(" 结束时间 "),Ee={class:"loadbill-set-unit"},ne=C(" 每页条数 "),Ce=l("span",null," ",-1),de=l("hr",null,null,-1),oe={style:{"margin-bottom":"10px"}},re={style:{position:"relative","text-align":"left"}},Ne={class:"sum-up"},he=C(" 支出:   "),Oe={class:"txt-red"},ce=l("br",null,null,-1),Re={class:"sum-up"},ue=C(" 收入:   "),Me={class:"txt-green"},pe=l("br",null,null,-1),Ue={class:"sum-up"},ge=C(" 结余:   "),me={style:{position:"absolute",right:"0px",bottom:"2px","text-align":"right"}},Se=l("br",null,null,-1),ye=l("br",null,null,-1),Le={style:{"margin-bottom":"10px"}},_e={class:"pagenation-container"},Ie={style:{position:"relative",margin:"10px auto",width:"230px"}},be=C(" 在此页搜索 "),De={class:"bills"},Be={class:"table table-striped"},ve=l("thead",null,[l("th",null,"操作"),l("th",{style:{"min-width":"100px"}},"日期"),l("th",null,"事项"),l("th",null,"分类"),l("th",{style:{"min-width":"150px"}},"账户"),l("th",null,"金额")],-1),Ye={class:"table-group-divider"},fe=l("i",{class:"fa-solid fa-eye"},null,-1),Ke=l("br",null,null,-1),we=l("i",{class:"fa-solid fa-trash-can"},null,-1),Ge={style:{display:"inline-block"}},Pe={key:0,style:{color:"red"},class:"fa-solid fa-arrow-down"},xe={key:1},ke={key:2,style:{color:"green"},class:"fa-solid fa-arrow-up"},Ve={key:0,style:{color:"green"},class:"fa-solid fa-arrow-up"},je={key:1,style:{color:"red"},class:"fa-solid fa-arrow-down"},Fe={key:2,style:{color:"orange"},class:"fa-solid fa-repeat"},We=l("br",null,null,-1),$e=C(" 日期: "),ze=C(" 模板: "),He=l("br",null,null,-1),qe=l("br",null,null,-1),Je=C(" 事项: "),Ze=C(" 性质: "),Qe=l("br",null,null,-1),Xe=C(" 分类: "),et=C(" 支出账户: "),tt=C(" 收入账户: "),lt=C(" 金额: "),it=C(" 备注: "),at=C(" 详细描述: "),At={style:{"text-align":"center"}},st={style:{"text-align":"center"}},Tt=C(" 账户: "),Et=l("br",null,null,-1),nt=C(" 类型: "),Ct={style:{"text-align":"center"}},dt=l("br",null,null,-1),ot=C(" 分类: "),rt=l("br",null,null,-1),Nt=C(" 性质: "),ht=l("option",null,"收入",-1),Ot=l("option",null,"支出",-1),ct={style:{"text-align":"center"}},Rt=l("br",null,null,-1),ut={key:0},Mt=l("hr",null,null,-1),pt={class:"sum-up"},Ut=C(" 支出:   "),gt={class:"txt-red"},mt=l("br",null,null,-1),St={class:"sum-up"},yt=C(" 收入:   "),Lt={class:"txt-green"},_t=l("br",null,null,-1),It={class:"sum-up"},bt=C(" 结余:   "),Dt={style:{"text-align":"center"}},Bt={key:0},vt=l("hr",null,null,-1),Yt={class:"sum-up"},ft=C(" 金额:   "),Kt={style:{"text-align":"center"}};ee.render=function(A,r,N,h,O,c){const R=d("DatePickerUnit"),u=d("Login");return e(),t("div",te,[O.isLoggedin?(e(),t("div",le,[l("div",ie,[ae,l("div",Ae,[se,l(R,{onDateChanged:c.changeFilterStartDate,startYear:O.startYear,endYear:O.endYear,year:O.filter.startDate.year,month:O.filter.startDate.month,day:O.filter.startDate.day},null,8,["onDateChanged","startYear","endYear","year","month","day"]),Te,l(R,{onDateChanged:c.changeFilterEndDate,startYear:O.startYear,endYear:O.endYear,year:O.filter.endDate.year,month:O.filter.endDate.month,day:O.filter.endDate.day},null,8,["onDateChanged","startYear","endYear","year","month","day"])]),l("div",Ee,[ne,i(l("select",{"onUpdate:modelValue":r[1]||(r[1]=e=>O.perPageSelected=e)},[(e(!0),t(E,null,n(O.perPageOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],512),[[T,O.perPageSelected,void 0,{number:!0}]]),Ce,l("button",{onClick:r[2]||(r[2]=e=>c.loadNewBill(1))},"加载账单")]),l("button",{onClick:r[3]||(r[3]=(...e)=>c.logout&&c.logout(...e)),style:{position:"absolute",top:"10px",right:"10px"}},"登出")]),de,l("div",oe,[l("button",{onClick:r[4]||(r[4]=(...e)=>c.showSumAcc&&c.showSumAcc(...e))},"查看账户汇总"),l("button",{onClick:r[5]||(r[5]=(...e)=>c.showSumCat&&c.showSumCat(...e))},"查看分类汇总")]),l("div",re,[l("span",Ne,[he,l("span",Oe,s(O.expenseTotal),1)]),ce,l("span",Re,[ue,l("span",Me,s(O.incomeTotal),1)]),pe,l("span",Ue,[ge,l("span",{class:c.getReserveClass(O.reserveTotal.val)},s(O.reserveTotal.text),3)]),l("div",me,[l("button",{onClick:r[6]||(r[6]=(...e)=>c.showAccDetail&&c.showAccDetail(...e))},"编辑账户"),Se,l("button",{onClick:r[7]||(r[7]=(...e)=>c.showCatDetail&&c.showCatDetail(...e))},"编辑分类"),ye,l("button",{onClick:r[8]||(r[8]=e=>c.showBillDetail(-1))},"新增账单")])]),l("div",Le," 共"+s(O.pageNumOption[O.pageNumOption.length-1])+"页, 共"+s(O.bills.length)+"条记录 ",1),l("div",_e,[l("div",null,[l("span",{class:["page-item",c.prevNext.prevStyle],onClick:r[9]||(r[9]=(...e)=>c.goToPrev&&c.goToPrev(...e))}," « ",2),i(l("select",{style:{"margin-top":"-1","min-width":"50px",height:"24px","text-align":"center"},onChange:r[10]||(r[10]=(...e)=>c.loadBill&&c.loadBill(...e)),"onUpdate:modelValue":r[11]||(r[11]=e=>O.curPage=e)},[(e(!0),t(E,null,n(O.pageNumOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],544),[[T,O.curPage,void 0,{number:!0}]]),l("span",{class:["page-item",c.prevNext.nextStyle],onClick:r[12]||(r[12]=(...e)=>c.goToNext&&c.goToNext(...e))}," » ",2)])]),l("div",Ie,[be,i(l("input",{placeholder:"输入关键字...",style:{width:"134px",height:"34px","font-size":"16px","border-radius":"6px"},onInput:r[13]||(r[13]=(...e)=>c.searchWithinPage&&c.searchWithinPage(...e)),"onUpdate:modelValue":r[14]||(r[14]=e=>O.searchKW=e),type:"text"},null,544),[[a,O.searchKW]]),l("div",{class:["close-btn",{hide:!O.searchKW}],onClick:r[15]||(r[15]=(...e)=>c.clearSearch&&c.clearSearch(...e)),style:{top:"-7px","font-size":"30px",right:"10px"}}," × ",2)]),l("div",De,[l("table",Be,[ve,l("tbody",Ye,[(e(!0),t(E,null,n(O.curPageBills,((i,a)=>(e(),t("tr",{class:O.searchResultClass[a],key:i.id},[l("td",null,[l("span",{class:"act-btn",title:"查看详情",onClick:e=>c.showBillDetail(a)},[fe],8,["onClick"]),Ke,l("span",{class:"act-btn",title:"删除",onClick:e=>c.delBill(i.id)},[we],8,["onClick"])]),l("td",null,[l("span",Ge,s(i.DATE),1)]),l("td",null,s(i.NAME),1),l("td",null,s(i.CATEGORY),1),l("td",null,[i.ACC_OUT?(e(),t("i",Pe)):o("",!0),C(" "+s(i.ACC_OUT)+" ",1),i.ACC_OUT?(e(),t("br",xe)):o("",!0),i.ACC_IN?(e(),t("i",ke)):o("",!0),C(" "+s(i.ACC_IN),1)]),l("td",null,["收入"==i.NATURE?(e(),t("i",Ve)):o("",!0),"支出"==i.NATURE?(e(),t("i",je)):o("",!0),"转账"==i.NATURE?(e(),t("i",Fe)):o("",!0),We,C(" "+s(i.AMOUNT),1)])],2)))),128))])])]),l("div",{class:["overlay",{show:O.isShowOverlay}],onClick:r[16]||(r[16]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},null,2),l("div",{class:["view-container",{show:O.isShowBill}]},[l("p",null,[$e,l("button",{onClick:r[17]||(r[17]=(...e)=>c.loadToday&&c.loadToday(...e))},"今天"),ze,i(l("select",{style:{"margin-top":"-1","min-width":"50px",height:"24px","text-align":"center"},onChange:r[18]||(r[18]=(...e)=>c.loadBillTemplate&&c.loadBillTemplate(...e)),"onUpdate:modelValue":r[19]||(r[19]=e=>O.billTemplateName=e)},[(e(!0),t(E,null,n(O.billTemplateOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],544),[[T,O.billTemplateName]]),He,qe,l(R,{onDateChanged:c.changeBillDate,startYear:O.startYear,endYear:O.endYear,year:O.billSelected.year,month:O.billSelected.month,day:O.billSelected.day},null,8,["onDateChanged","startYear","endYear","year","month","day"])]),l("p",null,[Je,i(l("input",{"onUpdate:modelValue":r[20]||(r[20]=e=>O.billSelected.NAME=e),type:"text"},null,512),[[a,O.billSelected.NAME]])]),l("p",null,[Ze,i(l("select",{"onUpdate:modelValue":r[21]||(r[21]=e=>O.billSelected.NATURE=e),onChange:r[22]||(r[22]=(...e)=>c.loadCategory&&c.loadCategory(...e))},[(e(!0),t(E,null,n(O.natureOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],544),[[T,O.billSelected.NATURE]]),Qe,l("span",{class:{hide:"转账"==O.billSelected.NATURE||""==O.billSelected.NATURE}},[Xe,i(l("select",{"onUpdate:modelValue":r[23]||(r[23]=e=>O.billSelected.CATEGORY=e)},[(e(!0),t(E,null,n(c.categoryOption,((l,i)=>(e(),t("option",{key:i},s(l),1)))),128))],512),[[T,O.billSelected.CATEGORY]])],2)]),l("p",null,[l("span",{class:{hide:"收入"==O.billSelected.NATURE}},[et,i(l("select",{"onUpdate:modelValue":r[24]||(r[24]=e=>O.billSelected.ACC_OUT=e)},[(e(!0),t(E,null,n(O.accounts,((l,i)=>(e(),t("option",{key:i},s(l.NAME),1)))),128))],512),[[T,O.billSelected.ACC_OUT]])],2),l("br",{class:{hide:"收入"==O.billSelected.NATURE}},null,2),l("span",{class:{hide:"支出"==O.billSelected.NATURE}},[tt,i(l("select",{"onUpdate:modelValue":r[25]||(r[25]=e=>O.billSelected.ACC_IN=e),title:O.billSelected.ACC_OUT},[(e(!0),t(E,null,n(O.accounts,((l,i)=>(e(),t("option",{key:i},s(l.NAME),1)))),128))],8,["title"]),[[T,O.billSelected.ACC_IN]])],2)]),l("p",null,[lt,i(l("input",{"onUpdate:modelValue":r[26]||(r[26]=e=>O.billSelected.AMOUNT=e),type:"number"},null,512),[[a,O.billSelected.AMOUNT]])]),l("p",null,[it,i(l("input",{placeholder:"选填","onUpdate:modelValue":r[27]||(r[27]=e=>O.billSelected.REMARK=e),type:"text"},null,512),[[a,O.billSelected.REMARK]])]),l("p",null,[at,i(l("textarea",{placeholder:"选填",style:{width:"100%",height:"100px"},"onUpdate:modelValue":r[28]||(r[28]=e=>O.billSelected.NOTES=e)},null,512),[[a,O.billSelected.NOTES]])]),l("div",At,[O.isUpdateBill?(e(),t("button",{key:0,onClick:r[29]||(r[29]=(...e)=>c.updateBill&&c.updateBill(...e))},"更新")):o("",!0),l("button",{onClick:r[30]||(r[30]=(...e)=>c.addBill&&c.addBill(...e))},"另存"),l("button",{onClick:r[31]||(r[31]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"取消")]),l("div",st,[l("button",{onClick:r[32]||(r[32]=(...e)=>c.saveBillTemplate&&c.saveBillTemplate(...e))},"存为模板"),l("button",{onClick:r[33]||(r[33]=(...e)=>c.delBillTemplate&&c.delBillTemplate(...e))},"删除模板")]),l("div",{class:"close-btn",onClick:r[34]||(r[34]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"×")],2),l("div",{class:["view-container",{show:O.isShowAcc}]},[(e(!0),t(E,null,n(O.accEditing,((A,s)=>(e(),t("div",{class:"view-acc",key:s},[Tt,i(l("input",{"onUpdate:modelValue":e=>A.NAME=e},null,8,["onUpdate:modelValue"]),[[a,A.NAME]]),Et,nt,i(l("input",{"onUpdate:modelValue":e=>A.TYPE=e},null,8,["onUpdate:modelValue"]),[[a,A.TYPE]])])))),128)),l("div",Ct,[l("button",{onClick:r[35]||(r[35]=e=>c.addAcc(O.accEditing.length))},"新增账户"),dt,l("button",{onClick:r[36]||(r[36]=(...e)=>c.updateAcc&&c.updateAcc(...e))},"更新"),l("button",{onClick:r[37]||(r[37]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"取消")]),l("div",{class:"close-btn",onClick:r[38]||(r[38]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"×")],2),l("div",{class:["view-container",{show:O.isShowCat}]},[(e(!0),t(E,null,n(O.catEditing,((A,s)=>(e(),t("div",{class:"view-acc",key:s},[ot,i(l("input",{"onUpdate:modelValue":e=>A.NAME=e},null,8,["onUpdate:modelValue"]),[[a,A.NAME]]),rt,Nt,i(l("select",{"onUpdate:modelValue":e=>A.TYPE=e,class:c.getTypeClass(A.TYPE)},[ht,Ot],10,["onUpdate:modelValue"]),[[T,A.TYPE]])])))),128)),l("div",ct,[l("button",{onClick:r[39]||(r[39]=e=>c.addCat(O.catEditing.length))},"新增分类"),Rt,l("button",{onClick:r[40]||(r[40]=(...e)=>c.updateCat&&c.updateCat(...e))},"更新"),l("button",{onClick:r[41]||(r[41]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"取消")]),l("div",{class:"close-btn",onClick:r[42]||(r[42]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"×")],2),l("div",{class:["view-container",{show:O.isShowSumAcc}]},[O.sumAcc.length?(e(),t("div",ut,[(e(!0),t(E,null,n(O.sumAcc,((l,i)=>(e(),t("button",{key:"opt"+i,class:c.getSumAccBtnClass(l[0].TYPE),onClick:e=>c.setActiveSumAccType(l[0].TYPE)},s(l[0].TYPE),11,["onClick"])))),128))])):o("",!0),Mt,(e(!0),t(E,null,n(O.sumAcc,((i,a)=>(e(),t("div",{key:a,class:c.getSumAccTypeClass(i[0].TYPE)},[(e(!0),t(E,null,n(i,((i,A)=>(e(),t("div",{class:"view-acc",key:a+"-"+A},[l("h3",null,s(i.NAME),1),l("span",pt,[Ut,l("span",gt,s(i.expenseTotal),1)]),mt,l("span",St,[yt,l("span",Lt,s(i.incomeTotal),1)]),_t,l("span",It,[bt,l("span",{class:c.getReserveClass(i.reserveTotal.val)},s(i.reserveTotal.text),3)])])))),128))],2)))),128)),l("div",Dt,[l("button",{onClick:r[43]||(r[43]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"关闭")]),l("div",{class:"close-btn",onClick:r[44]||(r[44]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"×")],2),l("div",{class:["view-container",{show:O.isShowSumCat}]},[O.sumCat.length?(e(),t("div",Bt,[(e(!0),t(E,null,n(O.sumCat,((l,i)=>(e(),t("button",{key:"opt"+i,class:c.getSumCatBtnClass(l[0].TYPE),onClick:e=>c.setActiveSumCatType(l[0].TYPE)},s(l[0].TYPE),11,["onClick"])))),128))])):o("",!0),vt,(e(!0),t(E,null,n(O.sumCat,((i,a)=>(e(),t("div",{key:a},[(e(!0),t(E,null,n(i,((A,T)=>(e(),t("div",{class:["view-acc",c.getSumCatTypeClass(i[0].TYPE)],key:a+"-"+T},[l("h3",null,s(A.NAME),1),l("span",Yt,[ft,l("span",{class:c.getTxtClass(A.TYPE)},s(A.total),3)])],2)))),128))])))),128)),l("div",Kt,[l("button",{onClick:r[45]||(r[45]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"关闭")]),l("div",{class:"close-btn",onClick:r[46]||(r[46]=(...e)=>c.hideOverlay&&c.hideOverlay(...e))},"×")],2)])):o("",!0),O.isLoggedin?o("",!0):(e(),t(u,{key:1,errorMsg:O.login_errMsg,onLogin:c.getLoginInfo},null,8,["errorMsg","onLogin"]))])},r(ee).mount("#app");
